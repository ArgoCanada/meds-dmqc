# BGC DMQC Workshop 2026 - Notes
Villefranche-sur-mer, France
January 26-30, 2026

## Oxygen adjustment in partial pressure or concentration space

During the workshop, I wrote some code to use text files generated by Henry Bittig that describe the best methodology for DOXY adjustment on a given float and the associated coefficients for that adjustment. The equation for this adjustment is written as: 

`DOXY_ADJUSTED=f(PPOX_DOXY_ADJUSTED); PPOX_DOXY_ADJUSTED=(SLOPE*(1+DRIFT/100.*(profile_date_juld-launch_date_juld)/365)+INCLINE_T*TEMP)*(PPOX_DOXY+OFFSET); PPOX_DOXY=f(DOXY);`

Where `f(PPOX_DOXY_ADJUSTED)` is the unit conversion from partial pressure (mbar) to concentration (umol/kg). I did this in two steps: 

1. Convert partial pressure to concentration in umol/L using a function from SCOR WG 142 (1) translated to python:

```python 
def pO2_to_doxy(pO2, S, T, P=0):
    '''
    convert oxygen partial pressure to molar oxygen concentration

    Args:
        pO2 (float or array-like): oxygen partial pressure in mbar
        S (float or array-like): salinity (PSS-78)
        T (float or array-like): temperature in deg C
        P (optional, float or array-like): hydrostatic pressure in dbar (default: 0 dbar)

    Returns:
        DOXY: oxygen concentration in umol L-1

    according to recommendations by SCOR WG 142 "Quality Control Procedures
    for Oxygen and Other Biogeochemical Sensors on Floats and Gliders"


    Written in matlab by:
    Henry Bittig
    Laboratoire d'Oceanographie de Villefranche-sur-Mer, France
    bittig@obs-vlfr.fr
    28.10.2015
    19.04.2018, v1.1, fixed typo in B2 exponent

    Translated to python by:
    Christopher Gordon
    Bedford Institute of Oceanography, Fisheries and Oceans Canada
    chris.gordon@dfo-mpo.gc.ca
    02.10.2020
    '''

    Tk      = T + 273.15 # temperature in kelvin
    xO2     = 0.20946 # mole fraction of O2 in dry air (Glueckauf 1951)
    pH2Osat = pH2O(T, S=S, unit='mbar') # saturated water vapor in mbar
    # scaled temperature for use in TCorr and SCorr
    sca_T   = np.log((298.15 - T)/(Tk))
    # temperature correction part from Garcia and Gordon (1992), Benson and Krause (1984) refit mL(STP) L-1; and conversion from mL(STP) L-1 to umol L-1
    Tcorr   = 44.6596 * np.exp(2.00907 + 3.22014*sca_T + 4.05010*sca_T**2 + 4.94457*sca_T**3 - 2.56847e-1*sca_T**4 + 3.88767*sca_T**5)
    # salinity correction part from Garcia and Gordon (1992), Benson and Krause (1984) refit ml(STP) L-1
    Scorr   = np.exp(S*(-6.24523e-3 - 7.37614e-3*sca_T - 1.03410e-2*sca_T**2 - 8.17083e-3*sca_T**3) - 4.88682e-7*S**2)
    Vm      = 0.317 # molar volume of O2 in m3 mol-1 Pa dbar-1 (Enns et al. 1965)
    R       = 8.314 # universal gas constant in J mol-1 K-1

    O2conc  = pO2/(xO2*(1013.25 - pH2Osat))*(Tcorr*Scorr)/np.exp(Vm*P/(R*Tk))

    return O2conc
```

2. Convert oxygen in umol/L to umol/kg seawater, effectively by:

`DOXY(umol/kg) = DOXY(umol/L) * 1000(L/m3) * 1/pot_density(kg/m3)`

With the reference pressure for potential density being the surface. 

```python
def umol_per_L_to_umol_per_sw(doxy, S, T, P, lat=None, lon=None):
    '''
    Convert dissolved oxygen concentration in umol L-1 to umol kg-1.

    Args:
        doxy (float or array-like): dissolved oxygen in umol kg-1
        S (float or array-like): salinity, array of same length as `doxy` or single value
        T (float or array-like): temperature (deg C), array of same length  as `doxy` or single value
        P (float or array-like): pressure (dbar), array of same length  as `doxy` or single value
        Pref (optional, float): reference pressure (dbar) for potential density calculation, default 0
        lat (optional, float or array-like): latitude (deg) for absolute salinity calculation, optional but highly encouraged, function will use practical salinity and produce warning without it
        lon (optional, float or array-like): longitude (deg) for absolute salinity calculation, optional but highly encouraged, function will use practical salinity and produce warning without it

    Returns:
        umol_kg_conc (float or array-like): dissolved oxygen concentration in umol kg-1
    '''

    pot_density = gsw.pot_rho_t_exact(gsw.SA_from_SP(S, P, lon, lat), T, P, 0)
    umol_kg_conc = doxy * 1000 / pot_density

    return umol_kg_conc
```

## References

1. Bittig Henry, KÃ¶rtzinger Arne, Johnson Ken, Claustre Herve, Emerson Steve, Fennel Katja, Garcia Hernan, Gilbert Denis, Gruber Nicolas, Kang Dong-Jin, Naqvi Wajih, Prakash Satya, Riser Steven, Thierry Virginie, Tilbrook Bronte, Uchida Hiroshi, Ulloa Osvaldo, Xing Xiaogang (2018). *SCOR WG 142: Quality Control Procedures for Oxygen and Other Biogeochemical Sensors on Floats and Gliders. Recommendations on the conversion between oxygen quantities for Bio-Argo floats and other autonomous sensor platforms.* Ifremer. https://doi.org/10.13155/45915